<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>CDMOD: src/swcdmod2ht.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CDMOD
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">swcdmod2ht.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;par.h&quot;</code><br />
<code>#include &quot;su.h&quot;</code><br />
<code>#include &quot;segy.h&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6b20993ec01a368bf2e7936b5b22f1d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a6b20993ec01a368bf2e7936b5b22f1d7">ricker1_wavelet</a> (int nt, float dt, float fpeak, float *wavelet)</td></tr>
<tr class="memdesc:a6b20993ec01a368bf2e7936b5b22f1d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">ricker_wavelet &ndash; Compute the time response of a source function as a Ricker wavelet with peak frequency "fpeak" Hz.  <a href="#a6b20993ec01a368bf2e7936b5b22f1d7">More...</a><br /></td></tr>
<tr class="separator:a6b20993ec01a368bf2e7936b5b22f1d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90abc83e502e0cf87b482e8a67bc9e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#ad90abc83e502e0cf87b482e8a67bc9e3">extenModel</a> (int nx, int nz, int ntap, float **v, float **vv)</td></tr>
<tr class="memdesc:ad90abc83e502e0cf87b482e8a67bc9e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">extend the absorbing layer for velocity model  <a href="#ad90abc83e502e0cf87b482e8a67bc9e3">More...</a><br /></td></tr>
<tr class="separator:ad90abc83e502e0cf87b482e8a67bc9e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a707cef9b52a1fbb50f69a5bdcdc504fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a707cef9b52a1fbb50f69a5bdcdc504fe">absorb</a> (int ntap, int nx, int nz, float *taper, float **p)</td></tr>
<tr class="memdesc:a707cef9b52a1fbb50f69a5bdcdc504fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">applying ABC  <a href="#a707cef9b52a1fbb50f69a5bdcdc504fe">More...</a><br /></td></tr>
<tr class="separator:a707cef9b52a1fbb50f69a5bdcdc504fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f8852395acfbe8480c185d9a6af713"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a77f8852395acfbe8480c185d9a6af713">cerjan</a> (int ntap, float coeff, float *taper)</td></tr>
<tr class="memdesc:a77f8852395acfbe8480c185d9a6af713"><td class="mdescLeft">&#160;</td><td class="mdescRight">cerjan ABC coefficients  <a href="#a77f8852395acfbe8480c185d9a6af713">More...</a><br /></td></tr>
<tr class="separator:a77f8852395acfbe8480c185d9a6af713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b292299a5a7ebbba7b88f61efee2da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a04b292299a5a7ebbba7b88f61efee2da">get_file_snap</a> (char *dest, char *src, int num)</td></tr>
<tr class="memdesc:a04b292299a5a7ebbba7b88f61efee2da"><td class="mdescLeft">&#160;</td><td class="mdescRight">get snapshot file name  <a href="#a04b292299a5a7ebbba7b88f61efee2da">More...</a><br /></td></tr>
<tr class="separator:a04b292299a5a7ebbba7b88f61efee2da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97972f13a27a253327d118dc9a7559c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a97972f13a27a253327d118dc9a7559c8">src_spatial_distribution</a> (int nx, int nz, int ixs, int izs, float **s)</td></tr>
<tr class="memdesc:a97972f13a27a253327d118dc9a7559c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">source spatial dist for stability  <a href="#a97972f13a27a253327d118dc9a7559c8">More...</a><br /></td></tr>
<tr class="separator:a97972f13a27a253327d118dc9a7559c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa669def8dcd0bd78943d67d117749803"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#aa669def8dcd0bd78943d67d117749803">hanning</a> (int n, float *w)</td></tr>
<tr class="memdesc:aa669def8dcd0bd78943d67d117749803"><td class="mdescLeft">&#160;</td><td class="mdescRight">hanningnWindow - returns an n element long hanning window  <a href="#aa669def8dcd0bd78943d67d117749803">More...</a><br /></td></tr>
<tr class="separator:aa669def8dcd0bd78943d67d117749803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa01b8ceb43a2685d2809b9132b1ca0f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#aa01b8ceb43a2685d2809b9132b1ca0f5">cd_coeff_scalar</a> (int m, int np, float *d)</td></tr>
<tr class="memdesc:aa01b8ceb43a2685d2809b9132b1ca0f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculating CD coefficients  <a href="#aa01b8ceb43a2685d2809b9132b1ca0f5">More...</a><br /></td></tr>
<tr class="separator:aa01b8ceb43a2685d2809b9132b1ca0f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3f5ba134d674d999df8fd32b2a29df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a6c3f5ba134d674d999df8fd32b2a29df">time_one_step_cd</a> (int nx, int nz, float dt, float dx, float dz, int np, float *d, float *d4, float **v, float **pp, float **pm, float **p)</td></tr>
<tr class="memdesc:a6c3f5ba134d674d999df8fd32b2a29df"><td class="mdescLeft">&#160;</td><td class="mdescRight">time_one_step &ndash; compute wavefield of one time step.  <a href="#a6c3f5ba134d674d999df8fd32b2a29df">More...</a><br /></td></tr>
<tr class="separator:a6c3f5ba134d674d999df8fd32b2a29df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a753846abe99de978826841647bc11d0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a753846abe99de978826841647bc11d0b">cdcoeff</a> (int m, int n, double *cc)</td></tr>
<tr class="separator:a753846abe99de978826841647bc11d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">main function of cdmod2 using acoustic equation and higher-order in time <br />
shot seismograms calculated by CD method <br />
Usage: <br />
swcdmod2ht &lt; file_vel args &gt; file_seis <br />
args: nxmod=100 nzmod=100 for example <br />
 <a href="#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a381b0229c6cf78ce56a4749e35972291"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a381b0229c6cf78ce56a4749e35972291">sdoc</a> []</td></tr>
<tr class="separator:a381b0229c6cf78ce56a4749e35972291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ee33da3f54e2ea55665c50bfebd740"><td class="memItemLeft" align="right" valign="top">segy&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swcdmod2ht_8c.html#a21ee33da3f54e2ea55665c50bfebd740">tr</a></td></tr>
<tr class="separator:a21ee33da3f54e2ea55665c50bfebd740"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a707cef9b52a1fbb50f69a5bdcdc504fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void absorb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>taper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>applying ABC </p>

</div>
</div>
<a class="anchor" id="aa01b8ceb43a2685d2809b9132b1ca0f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cd_coeff_scalar </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculating CD coefficients </p>

</div>
</div>
<a class="anchor" id="a753846abe99de978826841647bc11d0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cdcoeff </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>calculation of CD coefficients for 2nd-order wave equations </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>order of the derivatives, m=1,2,3,4 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>order of spatial accuray, e.g., n=4, 10 </td></tr>
  </table>
  </dd>
</dl>
<p>loop variable, innter </p>

</div>
</div>
<a class="anchor" id="a77f8852395acfbe8480c185d9a6af713"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cerjan </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>coeff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>taper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cerjan ABC coefficients </p>

</div>
</div>
<a class="anchor" id="ad90abc83e502e0cf87b482e8a67bc9e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void extenModel </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>vv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>extend the absorbing layer for velocity model </p>

</div>
</div>
<a class="anchor" id="a04b292299a5a7ebbba7b88f61efee2da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_file_snap </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get snapshot file name </p>

</div>
</div>
<a class="anchor" id="aa669def8dcd0bd78943d67d117749803"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hanning </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>w</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>hanningnWindow - returns an n element long hanning window </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>size of window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*w</td><td>hanning window function of size n </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*w</td><td>hanning window function of size n</td></tr>
  </table>
  </dd>
</dl>
<p>Notes: w[k] = 0.5(1-cos(2PI * K/n+1)) k=1,....n </p>

</div>
</div>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main function of cdmod2 using acoustic equation and higher-order in time <br />
shot seismograms calculated by CD method <br />
Usage: <br />
swcdmod2ht &lt; file_vel args &gt; file_seis <br />
args: nxmod=100 nzmod=100 for example <br />
</p>
<ul>
<li>velocity model must be a binary file with v[nx][nz] order </li>
<li>output file is in SU format </li>
<li>snapshot file is in BINARY format same as velocity model, filename with no extension, e.g., file_snap="snap" </li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nxmod,nzmod</td><td>grid number of velocity model</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file_snap</td><td>filename of snapshot, default file_snap = "snap", no extension.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file_vseis</td><td>filename of velocity model, default file_vseis = "vseisht.su"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">file_hseis</td><td>filename of velocity model, default file_hseis = "hseisht.su"</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time sampling interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>time sampling number</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xs,zs</td><td>shot position</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dx,dz</td><td>spatial sampling interval</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fpeak</td><td>peak frequency, default fpeak=25</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fmax</td><td>maximum frequency, default fmax = 2.0*fpeak</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tdelay</td><td>time delay, default tdelay = 0</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">norder</td><td>spatial accuracy, default norder = 10</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mt</td><td>every mt time step to output snapshot, default mt=1</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coeff</td><td>coefficient for ABC, default coeff = 0.0053</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntap</td><td>grid number used to ABC, default ntap=45</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fx,fz</td><td>start position, default fx=fz=0</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsz</td><td>depth of horizontal line, default hsz=0</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vsx</td><td>horizontal position of VSP,default vsx = nxmod/2+ntap</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>flag output info, default verbose=1 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6b20993ec01a368bf2e7936b5b22f1d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ricker1_wavelet </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>fpeak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>wavelet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ricker_wavelet &ndash; Compute the time response of a source function as a Ricker wavelet with peak frequency "fpeak" Hz. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>time sampling number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time sampling interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fpeak</td><td>dominant frequency </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wavelet</td><td>array of wavelet</td></tr>
  </table>
  </dd>
</dl>
<p>Author: Tong Fei, 1993, Colorado School of Mines. </p>

</div>
</div>
<a class="anchor" id="a97972f13a27a253327d118dc9a7559c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void src_spatial_distribution </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ixs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>izs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>source spatial dist for stability </p>

</div>
</div>
<a class="anchor" id="a6c3f5ba134d674d999df8fd32b2a29df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void time_one_step_cd </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>d4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>pm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>time_one_step &ndash; compute wavefield of one time step. </p>
<hr/>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>number samples in x direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>number samples in z direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dx</td><td>x space step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dz</td><td>z space step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>length of spatial operators </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*d</td><td>array containing CD coefficients for 2nd-order spatial deritives </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*d4</td><td>array containing CD coefficients for 4th-order spatial deritives </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">**v</td><td>velocity model with v[nx][nz] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">**pp</td><td>pressure wavefiled at t+dt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">**pm</td><td>pressure wavefiled at t-dt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">**p</td><td>pressure wavefiled at t </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">**p</td><td>computed pressure wavefiled p</td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Weijia Sun, 2011, IGGCAS. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a381b0229c6cf78ce56a4749e35972291"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* sdoc[]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a21ee33da3f54e2ea55665c50bfebd740"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">segy tr</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
